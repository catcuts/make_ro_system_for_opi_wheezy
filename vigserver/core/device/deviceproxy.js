/*ã€€China Fujian Huanyutong Technology Co., Ltd. */
const{DocumentRecord:DocumentRecord}=require("../../core/storage"),{extractJsonItems:extractJsonItems}=require("utils/jsonfuncs"),VoerkaMessages=require("core/protocols/vimp/message");class DeviceProxyBase extends DocumentRecord{constructor(t,e){super(),this.__VIG_DEVICEPROXY__=!0,this.storageName="devices",this.storagePrimaryKey="sn",this.attrs={domain:0,enabled:!0,type:"",sn:t},this.devicetype=e}get vmc(){return void 0===this._vmc&&(this._vmc=VIGServices.getServices("vmc")),this._vmc}get sn(){return this.attrs.sn}set sn(t){this.attrs.sn=t}get type(){return this.attrs.type}set type(t){this.attrs.type=t}get name(){return this.attrs.name}set name(t){this.attrs.name=t}get enabled(){return this.attrs.enabled}set enabled(t){this.attrs.enabled=t}attrsIsCompleted(){}updateShortcutAttrs(){}from(t){this.attrs=t,this.updateShortcutAttrs()}get status(){return this.sn in VIGDevices.deviceCaches?VIGDevices.deviceCaches[this.sn].status:{}}async reload(){await this.load()}async update(t){let e=await super.update(t);return e&&!R.isEmpty(e)&&(Object.assign(this.attrs,e),this.updateShortcutAttrs()),e}async load(t){await super.load(t),this.updateShortcutAttrs()}async save(t){t&&(await super.save(t),this.from(t))}async onReady(){}get resumeAttrs(){return extractJsonItems(this.attrs,["timeZone","network","name","type","group","sn","datetime","model","owner","domain","romaing","location","wifi","broadcast"])}triggerEvent({...t}){this.vmc.triggerEvent(VoerkaMessages.Event({...t}))}triggerAlarm({...t}){this.vmc.triggerEvent(VoerkaMessages.Event({...t}))}}module.exports={DeviceProxyBase:DeviceProxyBase};