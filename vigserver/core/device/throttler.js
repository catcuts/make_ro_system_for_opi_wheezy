/*ã€€China Fujian Huanyutong Technology Co., Ltd. */
function getEventHistory(e){let t=VIGDevices.getDevice(e.from);return void 0===t.lastEvent?null:"object"==typeof t.lastEvent&&e.from in t.lastEvent?t.lastEvent[e.from]:null}function setEventHistory(e){let t=VIGDevices.getDevice(e.from);"object"!=typeof t.lastEvent&&(t.lastEvent={}),t.lastEvent[e.from]={time:(new Date).getTime(),code:e.payload.code,tid:e.tid||0}}function EventThrottler(e,t={}){if(!t.enabled)return e;let n=void 0===t.excludes?[]:t.excludes;if("string"==typeof n&&(n=n.includes(",")?n.split(","):[n]),n.includes(e.payload.code))return e;let l=void 0===t.interval?0:10;if(0===l)return e;let i=getEventHistory(e);return i&&i.time>(new Date).getTime()-1e3*l?(logger.debug(_("The message is throttled:{message}").params(JSON.stringify(e))),null):(setEventHistory(e),e)}module.exports={EventThrottler:EventThrottler};