{"version":3,"sources":["0"],"names":["async","require","VIGModuleManager","VIGModuleStatus","extractJsonItems","NormalMessage","DeviceManager","[object Object]","vigserver","super","this","enabledApi","enabledWeb","moduleType","storageName","host","VIGateway","deviceCaches","_deviceCacheAttrs","sn","name","value","status","vmc","triggerStatus","from","undefined","_vmc","VIGServices","getServices","defaultValue","e","newDevice","doc","VIGStorage","getDocument","query","$or","enabled","$exists","fields","reduce","k","item","devices","find","device","logger","debug","_","params","stack","load","updateCaches","devicetypes","modules","map","devicetypeInst","toLowerCase","attrs","entrys","entry","cls","errors","error","getModuleByName","getDeviceType","type","projections","findOne","options","exists","authorized","addDevice","update","upsert","returnUpdatedDocs","Object","assign","multi","$set","attrName","results","push","snOrDevice","message","to","dtype","target","VIGEventbus","send","payload","module","exports"],"mappings":"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"}