/*ã€€China Fujian Huanyutong Technology Co., Ltd. */
const glob=require("glob"),path=require("path"),fs=require("fs");let currentLanguage="default",languageRootFolder=VIGConsts.languageRootFolder,translates={};function getCurrentLanguage(){return currentLanguage}let ParamRegExp=/\{\w*\}/g;function changeLanguage(e="default"){if(["default","en","en-US"].includes(e))return translates={},currentLanguage=e;let t=path.join(languageRootFolder,e);if(!fs.existsSync(t))throw Error("The specified language does not exist.");try{let t=path.join(languageRootFolder,e,"main")+".json";translates.main=JSON.parse(fs.readFileSync(t,{encoding:"utf-8"})),currentLanguage=e}catch(t){logger.error(_("Failed to change to <{lang}> language:{message}").params(e,t.stack))}return currentLanguage}function getSupportedLanguages(){return glob.sync(languageRootFolder+"/").map(function(e){return path.basename(e)})}String.prototype.params=function(e){let t=this;if("object"==typeof e)for(let n in e)t=this.replace("{"+n+"}",e[n]);else{let e=0;for(let n of t.match(ParamRegExp)||[])e<arguments.length&&(t=t.replace(n,arguments[e]),e+=1)}return t},String.prototype.firstUpper=function(){return this.charAt(0).toUpperCase()+this.substring(1)},String.prototype.ljust=function(e,t=" "){return this+new Array(e-this.length).join(t)},String.prototype.rjust=function(e,t=" "){return new Array(e-this.length).join(t)+this},String.prototype.center=function(e,t=" "){let n=this,a=parseInt((e-n.length)/2);return new Array(a).join(t)+n+new Array(e-n.length-a).join(t)},global._=translate=function(e,t="main"){if("default"===currentLanguage)return e;try{return t in translates||(translates[t]=JSON.parse(fs.readFileSync(path.join(languageRootFolder,currentLanguage,t)+".json",encoding="utf-8"))),translates[t][e]}catch(t){return logger.warn(_("Unable to translate  '{message}' to {currentLanguage} language.").params(e,currentLanguage)),e}},changeLanguage(currentLanguage),module.exports={_:translate,getCurrentLanguage:getCurrentLanguage,translate:translate,changeLanguage:changeLanguage,getSupportedLanguages:getSupportedLanguages};