{"version":3,"sources":["0"],"names":["passport","require","LocalStrategy","Strategy","crypto","PassPortJWT","jsonwebtoekn","createPassword","content","Signture","createHmac","VIGateway","secret","update","digest","toString","verifyPassword","encrypted_password","password","VIGSettings","generateApiToken","username","opts","issuer","VIGConsts","ISSUER","audience","AUDIENCE","expiresIn","Attrs","api","sign","async","resetPassword","users","VIGStorage","openDocument","name","verifyAuthenticatedMiddleware","req","res","next","isAuthenticated","redirect","use","done","then","document","findOne","err","user","enabled","message","_","serializeUser","deserializeUser","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","secretOrKey","attrs","session","payload","CommonAuthMiddleware","authenticate","successRedirect","successFlash","failureRedirect","failureFlash","ApiAuthMiddleware","module","exports"],"mappings":";AAuCA,IAAIA,SAAWC,QAAQ,YACnBC,cAAgBD,QAAQ,kBAAkBE,SAC1CC,OAAOH,QAAQ,UACfI,YAAcJ,QAAQ,gBACtBK,aAAeL,QAAQ,gBAI3B,SAASM,eAAeC,GACpB,IAAIC,EAAWL,OAAOM,WAAW,OAAQC,UAAUC,QAEnD,OADAH,EAASI,OAAOL,GACTC,EAASK,SAASC,SAAS,UAEtC,SAASC,eAAeC,EAAmBC,GACvC,IAAIT,EAAWL,OAAOM,WAAW,OAAQS,YAAYP,QAErD,OADAH,EAASI,OAAOK,GACTT,EAASK,SAASC,SAAS,YAAYE,EAIlD,SAASG,iBAAiBC,GACtB,IAAIC,GAAMC,OAAOC,UAAUC,OAAOC,SAASF,UAAUG,UACjDC,EAAUjB,UAAUkB,MAAMC,IAAIF,WAAa,KAE/C,OADGA,IAAWN,EAAKM,UAAUA,GACtBtB,aAAayB,MAChBV,SAASA,GACXV,UAAUkB,MAAMjB,OAAOU,GAM7BU,eAAeC,cAAcZ,EAASH,GAClC,IAAIgB,QAAYC,WAAWC,aAAa,eAClCF,EAAMrB,QAAQwB,KAAKhB,IAAWH,SAASX,eAAeW,KAqDhE,SAASoB,8BAA8BC,EAAKC,EAAKC,GAC7C,GAAIF,EAAIG,kBACJ,OAAOD,IAEPD,EAAIG,SAAS,UArDrB3C,SAAS4C,IAAI,QAAS,IAAI1C,cAAc,SAAUmB,EAAUH,EAAU2B,GAE9DV,WAAWC,aAAa,SAASU,KAAKd,MAAOE,IACzCA,EAAMa,SAASC,SAASX,KAAMhB,GAAW,SAAU4B,EAAKC,GACpD,OAAID,EACOJ,EAAKI,GAEXC,EAGAlC,eAAekC,EAAKhC,SAAUA,GAG9BgC,EAAKC,QAGHN,EAAK,KAAMK,GAFPL,EAAK,MAAM,GAAQO,QAASC,EAAE,8BAH9BR,EAAK,MAAM,GAAQO,QAASC,EAAE,yBAH9BR,EAAK,MAAM,GAAQO,QAASC,EAAE,gCAgBzDrD,SAASsD,cAAc,SAAUJ,EAAML,GACnCA,EAAK,KAAMK,KAGflD,SAASuD,gBAAgB,SAAUL,EAAML,GACrCA,EAAK,KAAMK,KAMflD,SAAS4C,IAAI,MAAO,IAAIvC,YAAYF,UAC5BqD,eAAenD,YAAYoD,WAAWC,8BACtCC,YAAYhD,UAAUiD,MAAMhD,OAC5BW,OAAOC,UAAUC,OACjBC,SAASF,UAAUG,SACnBkC,SAAS,GAEb,SAASC,EAASjB,GACd,OAAOA,EAAK,KAAMiB,EAAQzC,aAelC,IAAI0C,qBAAuB/D,SAASgE,aAAa,SAC7CC,gBAAiB,IACjBC,aAAa,WACbC,gBAAiB,SACjBC,aAAc,kCAIdC,kBAAkBrE,SAASgE,aAAa,OAK5CM,OAAOC,SACHjC,8BAAAA,8BACAyB,qBAAAA,qBACAM,kBAAAA,kBACA9D,eAAAA,eACAS,eAAAA,eACAI,iBAAAA,iBACAa,cAAAA"}